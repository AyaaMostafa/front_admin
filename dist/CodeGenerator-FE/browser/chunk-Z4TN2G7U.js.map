{
  "version": 3,
  "sources": ["src/app/core/constants/app.constants.ts", "src/app/core/services/auth.service.ts", "src/app/core/services/translation.service.ts"],
  "sourcesContent": ["// API endpoints\r\nexport const API_ENDPOINTS = {\r\n    AUTH: {\r\n        LOGIN: '/auth/login',\r\n        REGISTER: '/auth/register',\r\n        LOGOUT: '/auth/logout',\r\n        REFRESH: '/auth/refresh',\r\n        PROFILE: '/auth/profile'\r\n    },\r\n    USERS: {\r\n        LIST: '/users',\r\n        DETAIL: (id: string) => `/users/${id}`,\r\n        UPDATE: (id: string) => `/users/${id}`,\r\n        DELETE: (id: string) => `/users/${id}`\r\n    },\r\n    CODE_GENERATOR: {\r\n        GENERATE: '/code-generator/generate',\r\n        TEMPLATES: '/code-generator/templates',\r\n        HISTORY: '/code-generator/history'\r\n    }\r\n} as const;\r\n\r\n// Storage keys\r\nexport const STORAGE_KEYS = {\r\n    TOKEN: 'auth_token',\r\n    REFRESH_TOKEN: 'refresh_token',\r\n    USER: 'user_data',\r\n    LANGUAGE: 'app_language',\r\n    THEME: 'app_theme'\r\n} as const;\r\n\r\n// Route paths\r\nexport const ROUTES = {\r\n    HOME: '/',\r\n    AUTH: {\r\n        LOGIN: '/auth/login',\r\n        REGISTER: '/auth/register'\r\n    },\r\n    DASHBOARD: '/dashboard',\r\n    SETTINGS: '/settings',\r\n    LANDING: '/landing'\r\n} as const;\r\n\r\n// App configuration constants\r\nexport const APP_CONFIG = {\r\n    TOKEN_EXPIRY_TIME: 3600000, // 1 hour in milliseconds\r\n    REQUEST_TIMEOUT: 30000, // 30 seconds\r\n    MAX_FILE_SIZE: 5242880, // 5MB in bytes\r\n    DEBOUNCE_TIME: 300 // milliseconds\r\n} as const;\r\n", "import { Injectable, signal, computed } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Router } from '@angular/router';\r\nimport { Observable, BehaviorSubject, tap, catchError, throwError, map } from 'rxjs';\r\nimport { environment } from '../../../environments/environment';\r\nimport { User, LoginResponse, LoginCredentials, RegisterData } from '../models';\r\nimport { STORAGE_KEYS, API_ENDPOINTS, ROUTES } from '../constants';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class AuthService {\r\n    private readonly apiUrl = environment.apiUrl;\r\n    private currentUserSubject = new BehaviorSubject<User | null>(this.getUserFromStorage());\r\n\r\n    // Signals for reactive state management\r\n    currentUser = signal<User | null>(this.getUserFromStorage());\r\n    isAuthenticated = computed(() => this.currentUser() !== null);\r\n\r\n    // Observable for legacy support\r\n    currentUser$ = this.currentUserSubject.asObservable();\r\n\r\n    constructor(\r\n        private http: HttpClient,\r\n        private router: Router\r\n    ) {\r\n        // Sync signal with BehaviorSubject\r\n        this.currentUser$.subscribe(user => this.currentUser.set(user));\r\n    }\r\n\r\n    /**\r\n     * Login user with credentials\r\n     */\r\n    login(credentials: LoginCredentials): Observable<LoginResponse> {\r\n        return this.http.post<LoginResponse>(\r\n            `${this.apiUrl}${API_ENDPOINTS.AUTH.LOGIN}`,\r\n            credentials\r\n        ).pipe(\r\n            tap(response => {\r\n                if (response.success && response.data) {\r\n                    this.handleLoginSuccess(response.data);\r\n                }\r\n            }),\r\n            catchError(error => this.handleAuthError(error))\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Register new user (if needed in the future)\r\n     */\r\n    register(data: RegisterData): Observable<any> {\r\n        return this.http.post<any>(\r\n            `${this.apiUrl}${API_ENDPOINTS.AUTH.REGISTER}`,\r\n            data\r\n        ).pipe(\r\n            catchError(error => this.handleAuthError(error))\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Logout current user\r\n     */\r\n    logout(): void {\r\n        this.clearAuthData();\r\n        this.currentUserSubject.next(null);\r\n        this.router.navigate([ROUTES.AUTH.LOGIN]);\r\n    }\r\n\r\n    /**\r\n     * Get current auth token\r\n     */\r\n    getToken(): string | null {\r\n        return localStorage.getItem(STORAGE_KEYS.TOKEN);\r\n    }\r\n\r\n    /**\r\n     * Check if user is authenticated\r\n     */\r\n    isLoggedIn(): boolean {\r\n        const token = this.getToken();\r\n        const user = this.currentUser();\r\n\r\n        if (!token || !user) {\r\n            return false;\r\n        }\r\n\r\n        // Check if token is expired\r\n        if (user.expiresOn) {\r\n            const expiryDate = new Date(user.expiresOn);\r\n            const now = new Date();\r\n            if (now >= expiryDate) {\r\n                this.logout();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Check if user has a specific permission\r\n     */\r\n    hasPermission(permission: string): boolean {\r\n        const user = this.currentUser();\r\n        return user?.permissions?.includes(permission) || false;\r\n    }\r\n\r\n    /**\r\n     * Check if user has a specific role\r\n     */\r\n    hasRole(role: string): boolean {\r\n        const user = this.currentUser();\r\n        return user?.roles?.includes(role) || false;\r\n    }\r\n\r\n    /**\r\n     * Get user permissions\r\n     */\r\n    getPermissions(): string[] {\r\n        return this.currentUser()?.permissions || [];\r\n    }\r\n\r\n    /**\r\n     * Get user roles\r\n     */\r\n    getRoles(): string[] {\r\n        return this.currentUser()?.roles || [];\r\n    }\r\n\r\n    /**\r\n     * Handle successful login\r\n     */\r\n    private handleLoginSuccess(data: any): void {\r\n        // Store token\r\n        localStorage.setItem(STORAGE_KEYS.TOKEN, data.token);\r\n\r\n        // Create user object\r\n        const user: User = {\r\n            userCode: data.userCode,\r\n            employeeName: data.employeeName,\r\n            roles: data.roles,\r\n            permissions: data.permissions,\r\n            genderId: data.genderId,\r\n            token: data.token,\r\n            expiresOn: data.expiresOn\r\n        };\r\n\r\n        // Store user data\r\n        localStorage.setItem(STORAGE_KEYS.USER, JSON.stringify(user));\r\n\r\n        // Update state\r\n        this.currentUserSubject.next(user);\r\n\r\n        console.log('Login successful:', {\r\n            user: data.employeeName,\r\n            roles: data.roles,\r\n            permissionsCount: data.permissions.length\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Handle authentication error\r\n     */\r\n    private handleAuthError(error: any): Observable<never> {\r\n        console.error('Authentication error:', error);\r\n\r\n        let errorMessage = 'An error occurred during authentication';\r\n\r\n        if (error.error?.message) {\r\n            errorMessage = error.error.message;\r\n        } else if (error.message) {\r\n            errorMessage = error.message;\r\n        } else if (error.status === 0) {\r\n            errorMessage = 'Unable to connect to the server. Please check your connection.';\r\n        } else if (error.status === 401) {\r\n            errorMessage = 'Invalid credentials. Please try again.';\r\n        } else if (error.status === 500) {\r\n            errorMessage = 'Server error. Please try again later.';\r\n        }\r\n\r\n        return throwError(() => ({ error: { message: errorMessage } }));\r\n    }\r\n\r\n    /**\r\n     * Get user from local storage\r\n     */\r\n    private getUserFromStorage(): User | null {\r\n        try {\r\n            const userJson = localStorage.getItem(STORAGE_KEYS.USER);\r\n            if (!userJson) return null;\r\n\r\n            const user = JSON.parse(userJson);\r\n\r\n            // Validate token expiry\r\n            if (user.expiresOn) {\r\n                const expiryDate = new Date(user.expiresOn);\r\n                const now = new Date();\r\n                if (now >= expiryDate) {\r\n                    this.clearAuthData();\r\n                    return null;\r\n                }\r\n            }\r\n\r\n            return user;\r\n        } catch (error) {\r\n            console.error('Error reading user from storage:', error);\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clear all authentication data\r\n     */\r\n    private clearAuthData(): void {\r\n        localStorage.removeItem(STORAGE_KEYS.TOKEN);\r\n        localStorage.removeItem(STORAGE_KEYS.REFRESH_TOKEN);\r\n        localStorage.removeItem(STORAGE_KEYS.USER);\r\n    }\r\n}\r\n", "import { Injectable, signal } from '@angular/core';\r\nimport { STORAGE_KEYS } from '../constants';\r\nimport { environment } from '../../../environments/environment';\r\n\r\ninterface Translations {\r\n    [key: string]: {\r\n        [lang: string]: string;\r\n    };\r\n}\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class TranslationService {\r\n    currentLanguage = signal<string>(environment.defaultLanguage);\r\n    availableLanguages = environment.supportedLanguages;\r\n\r\n    // Simple translation dictionary\r\n    private translations: Translations = {\r\n        'app.title': {\r\n            en: 'Code Generator',\r\n            ar: 'مولد الأكواد'\r\n        },\r\n        'auth.login': {\r\n            en: 'Login',\r\n            ar: 'تسجيل الدخول'\r\n        },\r\n        'auth.register': {\r\n            en: 'Register',\r\n            ar: 'التسجيل'\r\n        }\r\n    };\r\n\r\n    constructor() {\r\n        this.initializeLanguage();\r\n    }\r\n\r\n    /**\r\n     * Initialize language from storage or default\r\n     */\r\n    private initializeLanguage(): void {\r\n        const savedLanguage = localStorage.getItem(STORAGE_KEYS.LANGUAGE);\r\n        const browserLanguage = navigator.language.split('-')[0];\r\n\r\n        const languageToUse = savedLanguage ||\r\n            (this.availableLanguages.includes(browserLanguage)\r\n                ? browserLanguage\r\n                : environment.defaultLanguage);\r\n\r\n        this.setLanguage(languageToUse);\r\n    }\r\n\r\n    /**\r\n     * Change application language\r\n     */\r\n    setLanguage(language: string): void {\r\n        if (this.availableLanguages.includes(language)) {\r\n            this.currentLanguage.set(language);\r\n            localStorage.setItem(STORAGE_KEYS.LANGUAGE, language);\r\n            this.updateDocumentDirection(language);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Update document direction for RTL languages\r\n     */\r\n    private updateDocumentDirection(language: string): void {\r\n        const direction = language === 'ar' ? 'rtl' : 'ltr';\r\n        document.documentElement.setAttribute('dir', direction);\r\n        document.documentElement.setAttribute('lang', language);\r\n    }\r\n\r\n    /**\r\n     * Get translation for a key\r\n     */\r\n    instant(key: string, params?: any): string {\r\n        const lang = this.currentLanguage();\r\n        return this.translations[key]?.[lang] || key;\r\n    }\r\n\r\n    /**\r\n     * Switch between languages\r\n     */\r\n    toggleLanguage(): void {\r\n        const currentLang = this.currentLanguage();\r\n        const newLang = currentLang === 'en' ? 'ar' : 'en';\r\n        this.setLanguage(newLang);\r\n    }\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
