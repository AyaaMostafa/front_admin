<div class="code-type-list-container">

    <!-- Page Header -->
    <div class="page-header">
        <div>
            <h2 class="main-content-title">Code Types</h2>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="javascript:void(0)">Settings</a></li>
                <li class="breadcrumb-item active" aria-current="page">Code Type List</li>
            </ol>
        </div>
    </div>

    <!-- Card -->
    <div class="card custom-card">
        <!-- Card Top Bar -->
        <div class="card-top-bar">
            <div class="section-label">
                <span class="label-bar"></span>
                <span class="label-text">CODE TYPE LIST</span>
            </div>
            <div class="top-actions">
                <button class="btn btn-filter" (click)="toggleFilter()" id="filter-btn">
                    <i class="filter-icon">⚙</i> Filter
                </button>
                <button class="btn btn-add" (click)="navigateToAdd()" id="add-code-type-btn">
                    + Add
                </button>
            </div>
        </div>

        <!-- Filter Panel -->
        <div class="filter-panel" [class.filter-panel--open]="showFilter">
            <div class="filter-panel-inner">
                <div class="filter-row">
                    <div class="filter-field">
                        <label for="filter-name-en">Name (En)</label>
                        <input id="filter-name-en" type="text" class="form-control" [(ngModel)]="filterRequest.nameEn"
                            placeholder="Search by English name" />
                    </div>
                    <div class="filter-field">
                        <label for="filter-name-ar">Name (Ar)</label>
                        <input id="filter-name-ar" type="text" class="form-control" [(ngModel)]="filterRequest.nameAr"
                            placeholder="بحث بالاسم العربي" dir="rtl" />
                    </div>
                    <div class="filter-field">
                        <label for="filter-approved-by">Approved By</label>
                        <input id="filter-approved-by" type="text" class="form-control"
                            [(ngModel)]="filterRequest.approvedBy" placeholder="Search by approver" />
                    </div>
                    <div class="filter-actions">
                        <button class="btn btn-apply-filter" (click)="applyFilter()"
                            id="apply-filter-btn">Apply</button>
                        <button class="btn btn-reset-filter" (click)="resetFilter()"
                            id="reset-filter-btn">Reset</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Error -->
        @if (errorMessage) {
        <div class="alert-error">{{ errorMessage }}</div>
        }

        <!-- Loading -->
        @if (isLoading) {
        <div class="loading-spinner">
            <div class="spinner"></div>
            <span>Loading code types...</span>
        </div>
        }

        <!-- Table -->
        @if (!isLoading) {
        <div class="table-wrapper">
            <table class="data-table">
                <thead>
                    <tr>
                        <th class="col-num">#</th>
                        <th>Name (En)</th>
                        <th>Name (Ar)</th>
                        <th>Code</th>
                        <th>Description (En)</th>
                        <th>Description (Ar)</th>
                        <th>Approved By</th>
                        <th>Created Date</th>
                        <th class="col-actions">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @if (filteredCodeTypes.length === 0) {
                    <tr>
                        <td colspan="9" class="no-data">No code types found.</td>
                    </tr>
                    }
                    @for (item of filteredCodeTypes; track item.id; let i = $index) {
                    <tr class="table-row">
                        <td class="col-num">{{ i + 1 }}</td>
                        <td class="name-en">{{ item.nameEn }}</td>
                        <td class="name-ar" dir="rtl">{{ item.nameAr }}</td>
                        <td><span class="code-badge">{{ item.codeTypeCode }}</span></td>
                        <td class="desc-col">{{ item.descriptionEn || '—' }}</td>
                        <td class="desc-col" dir="rtl">{{ item.descriptionAr || '—' }}</td>
                        <td>{{ item.approvedBy || '—' }}</td>
                        <td>{{ formatDate(item.createdAt) }}</td>
                        <td class="actions-cell">
                            <button class="action-btn action-btn--edit" title="Edit" [id]="'edit-btn-' + item.id">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                                </svg>
                            </button>
                            <button class="action-btn action-btn--delete" title="Delete" [id]="'delete-btn-' + item.id">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <polyline points="3 6 5 6 21 6" />
                                    <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6" />
                                    <path d="M10 11v6" />
                                    <path d="M14 11v6" />
                                    <path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2" />
                                </svg>
                            </button>
                        </td>
                    </tr>
                    }
                </tbody>
            </table>
        </div>
        }
    </div>
</div>